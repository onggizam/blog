# HA Kubernetes Cluster 구축기

_by Seunggi Hong_

쿠버네티스를 쓰면서 늘 마음에 걸리던 게 하나 있었다.

바로 "중단되면 어떻게 하지?"라는 불안이었다.

사내 온프레미스 환경에 클러스터를 올려 개발 애플리케이션과 PoC를 운영하고 있었지만, Control Plane이 단 한 대뿐이라는 사실이 늘 신경 쓰였다. 노드가 죽는 순간, 클러스터 전체가 멈출 수밖에 없는 구조였다.

이 불안을 없애고 싶었다. 그래서 시작한 것이 바로 HA(High Availability)클러스터 구성 이다.

## Control Plane을 늘리며 느낀 점

처음 시도한 건 단순히 Control Plane을 한 대 더 붙이는 일이었다. 문서만 보면 쉬워 보이지만, 실제로는 인증서 문제부터 버전 차이, CRI 차이까지 변수가 많았다.

흥미로운 건, "다른 버전 쿠버네티스, 다른 런타임"이라는 조합에서도 결국 합류가 잘 된다는 사실이었다. 당연히 실패할 줄 알았는데, 의외로 매끄럽게 붙었다. 이런 과정을 겪으면서 "쿠버네티스가 생각보다 유연하다"라는 인상을 강하게 받았다.

## 로드밸런서, 단순함의 미학

Control Plane이 여러 대라면 그 앞단에 뭔가가 필요하다. 여기서 선택한 건 HAProxy + Keepalived 였다.

이유는 단순하다.

- 이미 오래 검증된 아키텍처
- L4/L7 모두 지원
- 설치도 쉽고 리소스도 가볍다

무겁고 복잡한 솔루션 대신, 딱 필요한 만큼만 구현하는 이 조합은 "실용적"이라는 말이 잘 어울렸다.

LB01이 죽으면 LB02로 VIP가 이동하는 모습을 확인했을 때, 작은 쾌감마저 느꼈다.

## 무중단 전환, 진짜 중요한 포인트

가장 민감했던 건 무중단 전환 이었다.

기존 ControlPlaneEndpoint를 VIP로 바꾸는 건 단순해 보이지만, 인증서에 VIP를 추가하지 않으면 바로 에러가 터진다.

실제 운영 중이라면 이게 곧 장애로 이어진다. 저도 그 순간, 인증서 SAN에 VIP를 추가하지 않아서 삽질을 했다.

이 경험이 준 교훈은 분명하다.

- HA의 본질은 노드를 늘리는 데 있지 않다.
- 신뢰할 수 있는 전환 과정 을 보장하는 게 핵심이다.

## etcd 백업, HA의 마지막 퍼즐

HA 구성을 했다고 해서 끝이 아니다.
Control Plane이 여러 대라도, etcd가 손상되면 클러스터는 여전히 무너진다.

그래서 정기적인 etcd 백업/복원 절차를 만들었다. 솔직히 말해, 처음엔 "일주일에 한 번이면 충분하지 않을까?"라고 생각했다.

하지만 실제로 장애를 겪어보니 하루에 한 번은 해야 마음이 놓인다 는 걸
뼈저리게 깨달았다.

## 돌아보며

이번 HA 구축 과정은 단순히 기술적인 도전만은 아니었다.

나에게는 운영자의 불안을 기술로 덜어내는 여정이었다.

- Control Plane 확장으로 "단일 장애 지점"을 없앴고,

## 마무리

쿠버네티스 HA 구성은 단순히 기술적인 작업이 아니다.

운영자 스스로에게 "내 시스템은 쉽게 무너지지 않는다"라는 확신을 주는 과정이다.

만약 지금 단일 Control Plane으로 클러스터를 운영 중이라면, 꼭 한 번 HA 구성을 고민해 보길 권한다.

불안은 줄고, 자신감은 늘어난다. 그리고 그 경험은 단순히 기술을 넘어, 운영자로서의 태도 를 바꿔줄 것이다.
